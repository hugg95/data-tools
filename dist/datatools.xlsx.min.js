/*
 datatools.js v0.0.1
 Author: victor.li https://github.com/lncwwn/data-tools
 License: MIT 
*/
var DataToolsSupport={flashState:!1,setState:function(){this.flashState=!0},test:function(){var a="flash avaliable now";console&&console.log?console.log(a):alert(a)}};!function(a,b){"use strict";function c(){}function d(a){var c='<div id="css-flash-object" style="position: absolute;width: 0; height: 0; z-index: 99999;"></div>',d='<embed src="'+a+'" width="0" height="0" quality="high" bgcolor="#ffffff" name="flash-object" id="js-flash-object" wmode="transparent" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"></embed>';document.documentMode&&document.documentMode<10&&(d='<object type="application/x-shockwave-flash" data="'+a+'" name="flash-object" id="js-flash-object"><param name="Movie" value="'+a+'" /><param name="AllowScriptAccess" value="always" /><param name="Quality" value="high" /><param name="BGColor" value="#ffffff" /><param name="WMode" value="Transparent" /></object>'),b("body").append(b(c).append(d))}function e(a,c,d,e){var f=b("#css-flash-object"),g=b("#js-flash-object"),h={width:d,height:e};f.css(h).css({left:a,top:c}),g.css(h)}function f(){b(this.config.className).unbind("mouseover"),b(this.config.className).unbind("click"),b("body").on("mouseover",this.config.className,function(a){var b=a.target;e(b.offsetLeft,b.offsetTop,b.clientWidth,b.clientHeight)})}function g(a){DataToolsSupport.flashState&&(this.registerFlash(),clearInterval(a))}var h={flashPath:"",fileName:"",sheetName:"",className:".js-export-btn",text:""};c.prototype.initFlash=function(){d(this.config.flashPath);var a=this,b=setInterval(function(){g.call(a,b)},100)},c.prototype.configure=function(a){this.config=b.extend(h,a),"."!==this.config.className.charAt(0)&&(this.config.className="."+this.config.className),f.call(this)},c.prototype.registerFlash=function(){if(DataToolsSupport.flashState){var a=document.getElementById("js-flash-object");a&&(a.setFileName(this.config.fileName),a.setData(this.config.text))}},a.DataTools=c}(window,jQuery),function(a,b){"use strict";function c(){this.SheetNames=[],this.Sheets={}}function d(a){var b=new RegExp(/^(\d+|\d+\.\d+)\%{1}$/);return b.test(a)}function e(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function f(a){for(var b={},c={s:{c:1e4,r:1e4},e:{c:0,r:0}},f=0;f<a.length;f++)for(var g=0;g<a[f].length;g++){var h={v:a[f][g]};if(c.s.c>g&&(c.s.c=g),c.s.r>f&&(c.s.r=f),c.e.c<g&&(c.e.c=g),c.e.r<f&&(c.e.r=f),null!==h.v){if("string"==typeof h.v&&(h.t="s",d(h.v))){h.t="n";var i=h.v.substr(0,h.v.length-1);h.v=Number(i)/100,h.z=XLSX.SSF._table[10]}"number"==typeof h.v&&(h.t="n",-1!==(h.t+"").indexOf(".")&&(h.z=XLSX.SSF._table[2])),"boolean"==typeof h.v&&(h.t="b"),h.v instanceof Date&&(h.t="n",h.z=XLSX.SSF._table[14],h.v=e(h.v));var j=XLSX.utils.encode_cell({c:g,r:f});b[j]=h}}return b["!ref"]=XLSX.utils.encode_range(c),b}function g(){var a=this.config.data,b=this.config.fileName.split("."),d=(b[0],this.config.sheetName),e=new c,g=f(a);e.SheetNames.push(d),e.Sheets[d]=g;for(var h=XLSX.write(e,{bookType:"xlsx",bookSST:!0,type:"binary"}),i=new ArrayBuffer(h.length),j=new Uint8Array(i),k=0;k<h.length;k++)j[k]=255&h.charCodeAt(k);saveAs(new Blob([i],{type:"application/octet-stream"}),this.config.fileName)}DataTools.prototype.initExcel=function(){b(this.config.className).unbind("mouseover"),b(this.config.className).unbind("click");var a=this;b("body").on("click",this.config.className,function(b){b.preventDefault(),g.call(a)})}}(window,jQuery);