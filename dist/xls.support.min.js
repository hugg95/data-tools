/*
 DataTools.js v1.0.0
 Author: victor.li https://github.com/lncwwn/data-tools
 License: MIT 
*/
!function(a,b){"use strict";function c(){this.SheetNames=[],this.Sheets={}}function d(a){var b=new RegExp(/^(\d+|\d+\.\d+)\%{1}$/);return b.test(a)}function e(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function f(a){for(var b={},c={s:{c:1e4,r:1e4},e:{c:0,r:0}},f=0;f<a.length;f++)for(var g=0;g<a[f].length;g++){var h={v:a[f][g]};if(c.s.c>g&&(c.s.c=g),c.s.r>f&&(c.s.r=f),c.e.c<g&&(c.e.c=g),c.e.r<f&&(c.e.r=f),null!==h.v){"string"==typeof h.v&&(h.t="s",d(h.v)&&(h.t="n",h.z=XLSX.SSF._table[10])),"number"==typeof h.v&&(h.t="n",-1!==(h.t+"").indexOf(".")&&(h.z=XLSX.SSF._table[2])),"boolean"==typeof h.v&&(h.t="b"),h.v instanceof Date&&(h.t="n",h.z=XLSX.SSF._table[14],h.v=e(h.v));var i=XLSX.utils.encode_cell({c:g,r:f});b[i]=h}}return b["!ref"]=XLSX.utils.encode_range(c),b}function g(){var a=this.config.data,b=this.config.fileName.split("."),d=b[0],e=b[1],g=this.config.sheetName,h=new c,i=f(a);h.SheetNames.push(g),h.Sheets[g]=i;for(var j=XLSX.write(h,{bookType:e,bookSST:!0,type:"binary"}),k=new ArrayBuffer(j.length),l=new Uint8Array(k),m=0;m<j.length;m++)l[m]=255&j.charCodeAt(m);saveAs(new Blob([k],{type:"application/octet-stream"}),d+"."+e)}DataTools.prototype.initExcel=function(){b(this.config.className).unbind("mouseover"),b(this.config.className).unbind("click");var a=this;b("body").on("click",this.config.className,function(b){b.preventDefault(),g.call(a)})}}(window,jQuery);