/*
 DataTools.js v1.0.0
 Author: victor.li https://github.com/lncwwn/data-tools
 License: MIT 
*/
!function(){"use strict";function a(){this.SheetNames=[],this.Sheets={}}function b(a){var b=new RegExp(/^(\d+|\d+\.\d+)\%{1}$/);return b.test(a)}function c(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function d(a){for(var d={},e={s:{c:1e4,r:1e4},e:{c:0,r:0}},f=0;f<a.length;f++)for(var g=0;g<a[f].length;g++){var h={v:a[f][g]};if(e.s.c>g&&(e.s.c=g),e.s.r>f&&(e.s.r=f),e.e.c<g&&(e.e.c=g),e.e.r<f&&(e.e.r=f),null!==h.v){"string"==typeof h.v&&(h.t="s",b(h.v)&&(h.t="n",h.z=XLSX.SSF._table[10])),"number"==typeof h.v&&(h.t="n",-1!==(h.t+"").indexOf(".")&&(h.z=XLSX.SSF._table[2])),"boolean"==typeof h.v&&(h.t="b"),h.v instanceof Date&&(h.t="n",h.z=XLSX.SSF._table[14],h.v=c(h.v));var i=XLSX.utils.encode_cell({c:g,r:f});d[i]=h}}return d["!ref"]=XLSX.utils.encode_range(e),d}function e(b,c,e,f){var g=new a,h=d(b);g.SheetNames.push(e),g.Sheets[e]=h;for(var i=XLSX.write(g,{bookType:f,bookSST:!0,type:"binary"}),j=new ArrayBuffer(i.length),k=new Uint8Array(j),l=0;l<i.length;l++)k[l]=255&i.charCodeAt(l);saveAs(new Blob([j],{type:"application/octet-stream"}),c+"."+f)}DataTools.prototype.saveExcel=e}(window);